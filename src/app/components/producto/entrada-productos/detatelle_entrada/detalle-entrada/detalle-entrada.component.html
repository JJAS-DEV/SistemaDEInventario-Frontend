<div class="container mt-5">
    <h1 class="mb-4 text-center text-primary fw-bold">📦 Proveedor: {{ entrada.proveedor.nombre }}</h1>
  
    <h1 class="mb-4 text-center text-primary fw-bold"> responsable: {{ entrada.responsable }}</h1>
  
    <div class="d-flex justify-content-end mb-3">
      <button class="btn btn-danger btn-sm" (click)="Ifmodificar()">
        ✏️ Modificar Entrada
      </button>
    </div>
    <button (click)="generatePDF()">Generar PDF</button>

    <h1>{{calcularTotalPrecio(entrada.productos)}}</h1>
    <div class="table-responsive shadow-sm rounded-4">
      <table class="table table-bordered table-hover align-middle text-center">
        <thead class="table-dark">
          <tr>
            <th># ID</th>
            <th>📦 Producto</th>
            <th>📦 Stock</th>
            <th>📥 Entrada</th>
            <th>💲 Precio unitario</th>
            <th>💲 Precio total</th>
            @if (modificar) {
              <th>🔁 Stock Modificado</th>
              <th>🗑️ Eliminar</th>
            }
          </tr>
        </thead>
  
        <tbody>
          @for (producto of entrada.productos; track $index) {
          <tr>
            <td>{{ producto.id }}</td>
            <td>{{ producto.producto.nombre }}</td>
            <td>{{ producto.producto.stock }}</td>
            <td>{{ buscarProducto(producto.producto.id) }}</td>
            <td>{{ producto.producto.precio }}</td>
<td>
  {{ calcularPrecioTotal(getCantidadProducto(producto.producto.id), producto.producto.precio)  }}
</td>

            @if (modificar) {
              @if (buscarProducto(producto.producto.id)!<=producto.producto.stock) {
                <td>
                  <input
                    type="number"
                    placeholder="Cantidad"
                    class="form-control my-2"
                    min="1"
                    [(ngModel)]="producto.cantidad"
                  />
                </td>
                <td>
                  <button
                    class="btn btn-danger btn-sm"
                    (click)="eliminar(producto.producto.id)"
                  >
                    Eliminar
                  </button>
                </td>
              } @else {
                <td>❌ No se puede modificar</td>
                <td>❌ No se puede eliminar</td>
              }
            }
          </tr>
          }
        </tbody>
      </table>
    </div>
  
    <div class="d-flex flex-wrap justify-content-start mt-3">
      @if (modificar) {
        <div class="me-2 mb-2">
          <button
            class="btn btn-success btn-sm"
            (click)="EnviarListaModificado(entrada.productos)"
          >
            ✅ Enviar Modificación
          </button>
        </div>
  
        @if (eliminarEntradad) {
          <div class="me-2 mb-2">
            <button class="btn btn-danger btn-sm" (click)="EliminarEntrada()">
              🗑️ Eliminar la Entrada
            </button>
          </div>
        } @else {
          <span class="text-danger ms-2">⚠️ No se puede eliminar la entrada</span>
        }
      }
    </div>
  </div>
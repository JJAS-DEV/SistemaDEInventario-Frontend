<div class="container mt-5">
<div class="container mt-4">
  <!-- Título de proveedor -->
  <div class="text-center">
    <h1 class="mb-3 text-primary fw-bold">📦 Proveedor: <span class="text-dark">{{ entrada.proveedor.nombre }}</span></h1>
    <h2 class="mb-4 text-secondary fw-semibold">👤 Responsable: <span class="text-dark">{{ entrada.responsable }}</span></h2>
  </div>

  <!-- Botones de acción -->
  <div class="d-flex justify-content-between align-items-center mb-4">
    <button class="btn btn-danger btn-sm d-flex align-items-center" (click)="Ifmodificar()">
      ✏️ <span class="ms-2">Modificar Entrada</span>
    </button>
    <button class="btn btn-success btn-sm d-flex align-items-center" (click)="generatePDF()">
      📄 <span class="ms-2">Generar PDF</span>
    </button>
  </div>
</div>
  <div class="table-responsive shadow-sm rounded-4">
    <table class="table table-bordered table-hover align-middle text-center">
      <thead class="table-dark">
        <tr>
          <th># ID</th>
          <th>📦 Producto</th>
          <th>📦 Stock</th>
          <th>📥 Entrada</th>
          <th>💲 Precio unitario</th>
          <th>💲 Precio total</th>
          @if (modificar) {
          <th>🔁 Stock Modificado</th>
          <th>🗑️ Eliminar</th>
          }
        </tr>
      </thead>

      <tbody>
        @for (producto of entrada.productos; track $index) {
        <tr>
          <td>{{ producto.id }}</td>
          <td>{{ producto.producto.nombre }}</td>
          <td>{{ producto.producto.stock }}</td>
          <td>{{ buscarProducto(producto.producto.id) }}</td>
          <td>{{ producto.producto.precio }}</td>
          <td>
            {{ calcularPrecioTotal(getCantidadProducto(producto.producto.id), producto.producto.precio) }}
          </td>

          @if (modificar) {
          @if (buscarProducto(producto.producto.id)!<=producto.producto.stock) { <td>
            <input type="number" placeholder="Cantidad" class="form-control my-2" min="1"
              [(ngModel)]="producto.cantidad" />
            </td>
            <td>
              <button class="btn btn-danger btn-sm" (click)="eliminar(producto.producto.id)">
                Eliminar
              </button>
            </td>
            } @else {
            <td>❌ No se puede modificar</td>
            <td>❌ No se puede eliminar</td>
            }
            }
        </tr>
        }
      </tbody>
    </table>
  </div>

  <div class="d-flex flex-wrap justify-content-start mt-3">
    @if (modificar) {
    <div class="me-2 mb-2">
      <button class="btn btn-success btn-sm" (click)="EnviarListaModificado(entrada.productos)">

        Enviar Modificación

      </button>
    </div>

    @if (eliminarEntradad) {
    <div class="me-2 mb-2">
      <button class="btn btn-danger btn-sm" (click)="EliminarEntrada()">
        🗑️ Eliminar la Entrada
      </button>
    </div>
    } @else {
    <span class="text-danger ms-2">⚠️ No se puede eliminar la entrada</span>
    }
    }



  </div>
</div>